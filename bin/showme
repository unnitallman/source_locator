#!/usr/bin/env ruby

require 'source_locator'

  rails_env_file = File.join(Dir.pwd, 'config', 'environment.rb')

if File.exists? rails_env_file
  puts "Loading Rails env..."
  require rails_env_file
end

if defined? Rails
  puts "Rails loaded."
  puts "Loading classes from the Rails app..."
  Rails.application.eager_load!
  puts "Done."
end

class_loader = SourceLocator::ClassLoader.new
data = class_loader.build

storage = SourceLocator::Dictionary.new data

locater = SourceLocator::Locater.new(storage, ARGV[0])
results = locater.find

editor = SourceLocator::Editors::SublimeText.new
editor.open results
